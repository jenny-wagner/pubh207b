<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lab 6: Analysis of Variance (ANOVA)</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PUBH 207B: Spring 2025</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="course_schedule.html">Course Schedule</a>
</li>
<li>
  <a href="install.html">Getting Started</a>
</li>
<li>
  <a href="about.html">Assignment Guidelines</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lab Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lab_1.html">Lab 1</a>
    </li>
    <li>
      <a href="Lab_2.html">Lab 2</a>
    </li>
    <li>
      <a href="Lab_3.html">Lab 3</a>
    </li>
    <li>
      <a href="Lab_4.html">Lab 4</a>
    </li>
    <li>
      <a href="Lab_5.html">Lab 5</a>
    </li>
    <li>
      <a href="Lab_6.html">Lab 6</a>
    </li>
    <li>
      <a href="Lab_7.html">Lab 7</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Lab 6: Analysis of Variance (ANOVA)</h1>

</div>


<p><br> <strong>Jenny Wagner, PhD, MPH</strong> <br> Department of
Public Health <br> California State University, Sacramento <br> <br></p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In Lab 5 last week, we discussed hypothesis testing as a framework
for making statistical inferences about population parameters using
sample data. We focused on hypothesis tests for comparing two groups,
such as the independent two-sample t-test. In Lab 6, we will extend our
hypothesis testing approach to situations where we need to compare more
than two groups. This is where Analysis of Variance (ANOVA) comes
in.</p>
<p>ANOVA, or Analysis of Variance, is a statistical method used to
determine whether there are statistically significant differences
between the means of three or more independent groups. Instead of
performing multiple t-tests (which would increase the risk of Type I
errors), ANOVA allows us to test for differences in means across several
groups with a single hypothesis test. ANOVA essentially allows us to
investigate whether there is a significant relationship between a
categorical independent variable (i.e., the “exposure”) and a continuous
dependent variable (i.e., “outcome” of interest).</p>
<p>ANOVA is commonly used in public health and medical research to
compare means across different groups, for example:</p>
<ul>
<li>Comparing average blood pressure levels among individuals with
different physical activity levels.</li>
<li>Examining differences in cholesterol levels across different smoking
status categories (e.g., non-smokers, former smokers, current
smokers).</li>
<li>Investigating whether BMI differs among participants with different
levels of educational attainment.</li>
</ul>
<p>Before we begin, there are a few key points to know about the ANOVA
procedure:</p>
<ol style="list-style-type: decimal">
<li>Like other hypothesis tests, ANOVA begins with setting up null and
alternative hypotheses. In the case of ANOVA, these hypotheses are
always as follows:</li>
</ol>
<ul>
<li><strong>Null Hypothesis (𝐻<sub>0</sub>)</strong>: The population
means are equal across all groups (i.e., there is no difference in
means).</li>
<li><strong>Alternative Hypothesis (𝐻<sub>𝑎</sub>)</strong>: At least
one group mean is different from the others.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><p>If the ANOVA test returns a statistically significant result
(i.e., a p-value smaller than the specified level of significance), we
conclude that <em>at least one</em> group mean is different from the
others. However, ANOVA does not tell us which groups differ — for that,
we need post-hoc tests, which we’ll get into later in this Lab.</p></li>
<li><p>For ANOVA to provide valid results, the following assumptions
must be met:</p></li>
</ol>
<ul>
<li><strong>Independence</strong> – The observations must be independent
within and across groups.</li>
<li><strong>Normality</strong> – The dependent variable (i.e., the
outcome of interest) should be approximately normally distributed within
each group.</li>
<li><strong>Homogeneity of variance (or homoscedasticity)</strong> – The
variance of the dependent variable (i.e., the outcome of interest)
should be similar across all groups (this can be checked using Levene’s
test for equality of variances).</li>
</ul>
<p>Because ANOVA requires these assumptions to be met, we will begin by
checking assumptions (after, of course, we prepare our dataset for
analysis).</p>
<p><br></p>
</div>
<div id="objectives" class="section level1">
<h1>Objectives</h1>
<p>After completing Lab 6, you will be able to:</p>
<ol style="list-style-type: decimal">
<li>State the null and alternative hypotheses for the ANOVA test</li>
<li>Check the assumptions of ANOVA</li>
<li>Conduct an ANOVA test to compare means across multiple groups</li>
<li>Interpret results of the ANOVA test</li>
<li>Conduct post-hoc pairwise comparisons when needed</li>
</ol>
<p><br></p>
</div>
<div id="tasks" class="section level1">
<h1>Tasks</h1>
<p>In Lab 6, we will continue working with the Framingham Heart Study
baseline sample to investigate cardiovascular risk factors.
Specifically, we will examine whether and to what extent baseline BMI
varies across levels of educational attainment.</p>
<p>When you are ready to start Lab 6:</p>
<ol style="list-style-type: decimal">
<li>First create a new R Markdown file using the instructions on the
Assignment Guidelines page. Save this <code>.Rmd</code> file in a folder
dedicated to Lab 6 materials.</li>
<li>Next, save the <strong>modified dataset</strong> you created in Lab
2 - called “frmgham2_p1_impute.csv” - in the same folder as your Lab 6 R
Markdown file. This is the same file we used Labs 4-5.</li>
<li>Finally, proceed to read through and carry out each of the tasks
detailed below. As usual, you will begin by loading R packages, setting
your working directory, and importing the dataset.</li>
</ol>
<p><br></p>
<div id="install-and-load-r-packages" class="section level2">
<h2>1. Install and load R packages</h2>
<p>In Lab 6, we will use functions from a few new packages. Copy and
paste the following into your Console (bottom-left window), then click
Return/Enter, to install the new packages:</p>
<pre><code>install.packages(c(&quot;rstatix&quot;, &quot;ggpubr&quot;, &quot;ggplot2&quot;))</code></pre>
<p>After these packages have been installed, they will need to be loaded
with the <code>library()</code> function each time you start a new R
session:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code></pre></div>
<p><br></p>
</div>
<div id="set-your-working-directory" class="section level2">
<h2>2. Set your working directory</h2>
<p>Set your working directory using the <code>setwd()</code> function
(see Assignment Guidelines for detailed instructions).</p>
<pre><code>setwd(&quot;YOUR FILE PATH HERE&quot;)</code></pre>
<p><br></p>
</div>
<div id="import-the-dataset-into-rstudio" class="section level2">
<h2>3. Import the dataset into RStudio</h2>
<p>Use the <code>read.csv()</code> function to bring in the modified
dataset you created in Lab 2. For this to work, the
“frmgham2_p1_impute.csv” file will need to be saved in the working
directory you specified in the above step. Again, this is the same data
file you started with in Labs 4-5.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># import dataset</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;frmgham2_p1_impute.csv&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>X)</span></code></pre></div>
<p><br></p>
</div>
<div id="prepare-the-dataset-for-analysis" class="section level2">
<h2>4. Prepare the dataset for analysis</h2>
<p>As usual, to prepare the dataset for analysis, we’ll need to modify
the variable types for sex, attained education, and obesity status.
While these variables take on numerical values in our dataset, these
values do not represent actual quantities - rather, they represent
categories with no inherent quantity. Remember that we also need to
specify whether a categorical or factor variable is ordered or unordered
(i.e., ordinal or nominal). Notice in the code chunks below that, for
<em>unordered</em> (i.e., nominal) categorical variables like sex and
obesity status, we specify <code>ordered = FALSE</code>, whereas, for
<em>ordered</em> (i.e., ordinal) categorical variables like attained
education, we specify <code>ordered = TRUE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># convert sex to unordered factor variable</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>data<span class="sc">$</span>SEX <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>SEX, </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                       <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>), </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                       <span class="at">ordered=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># convert attained education to ordered factor variable</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>data<span class="sc">$</span>EDUC <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>EDUC, </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                        <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>), </span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>                        <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># convert obesity status to unordered factor variable</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>data<span class="sc">$</span>OBESE <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>OBESE, </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                         <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>), </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                         <span class="at">ordered=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><br></p>
</div>
<div id="exploratory-data-analysis" class="section level2">
<h2>5. Exploratory data analysis</h2>
<p>In this Lab, we’ll investigate whether BMI differs across levels of
educational attainment, defined as:</p>
<ul>
<li>1: 0-11 years</li>
<li>2: High School Diploma, GED</li>
<li>3: Some College, Vocational School</li>
<li>4: College (BS, BA) degree or more</li>
</ul>
<p>Before carrying out more in-depth analyses using ANOVA, it’s
important to first explore the data to understand how BMI values vary
across education levels. As we learned in Lab 2, Exploratory Data
Analysis (EDA) helps us understand the distribution of variables of
interest, identify potential relationships, and detect potential
outliers (which could affect the assumptions of the ANOVA
procedure).</p>
<p>To start, we will:</p>
<ul>
<li>Calculate summary statistics (mean and standard deviation) for BMI
within each education level.</li>
<li>Visualize the data using boxplots to compare distributions of BMI
across education levels.</li>
<li>Check for outliers that may impact normality and variance
assumptions (more on assumptions in the next task).</li>
</ul>
<p>These initial steps will give us a clearer picture of the data before
performing any statistical tests.</p>
<p><br></p>
<div id="a.-compute-summary-statistics" class="section level3">
<h3>a. Compute summary statistics</h3>
<p>We’ve computed summary statistics in previous Labs, for example,
using the <code>summary()</code> function. This approach was useful for
quickly summarizing an entire dataset - but when we want to break down
summary statistics by group (in this case, by education level), we need
to use another approach. We can compute summary statistics
(specifically, mean and standard deviation) for BMI, stratified by
education level, using the following:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Compute summary statistics for BMI</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>bmi_summary <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="fu">group_by</span>(EDUC) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    <span class="at">BMI_mean =</span> <span class="fu">mean</span>(BMI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    <span class="at">BMI_sd =</span> <span class="fu">sd</span>(BMI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>()</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  )</span></code></pre></div>
<p>Let’s break down this code chunk:</p>
<ul>
<li><code>bmi_summary &lt;-</code>: Stores the result as an object
called <code>bmi_summary</code>.</li>
<li><code>data %&gt;%</code>: Uses the pipe operator to pass the dataset
<code>data</code> to the next function.</li>
<li><code>group_by(EDUC)</code>: Groups the dataset by the categorical
variable <code>EDUC</code> (education levels). This means that all
calculations carried out in the subsequent <code>summarise()</code>
function will be performed separately for each education group.</li>
<li><code>summarise()</code>: This function computes summary statistics
for each education group.
<ul>
<li><code>BMI_mean = mean(BMI, na.rm = TRUE)</code>: Calculates the mean
BMI for each group. Remember that the argument <code>na.rm = TRUE</code>
ensures that missing values (NA) are ignored in the calculation
(although we don’t actually have any missing values since we addressed
missingness in Lab 2).</li>
<li><code>BMI_sd = sd(BMI, na.rm = TRUE)</code>: Computes the standard
deviation of BMI for each group. The standard deviation measures how
much BMI values vary within each education level.</li>
<li><code>count = n()</code>: Counts the number of observations (sample
size) in each education level.</li>
</ul></li>
</ul>
<p>After running the above code chunk, you won’t actually see any output
in the Console. Rather, since we stored the result in an object called
<code>bmi_summary</code>, we will instead see this object appear in the
Environment window. To view the results, you can either manually click
on the object or use the <code>print()</code> function as follows:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Print summary statistics for BMI</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">print</span>(bmi_summary)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 4
##   EDUC  BMI_mean BMI_sd count
##   &lt;ord&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;
## 1 1         26.6   4.45  1935
## 2 2         25.3   3.85  1281
## 3 3         25.0   3.43   716
## 4 4         25.3   3.58   502</code></pre>
<p>Examine the output. You should see a table showing the mean
(BMI_mean), standard deviation (BMI_sd), and sample size (count)
stratified by education level (where each row corresponds to a different
education level. We can see there are some modest differences across
groups; for example, among those in education level 1 (0-11 years), mean
BMI appears to be higher than the other groups, with larger spread
indicated by the larger standard deviation. Conversely, education levels
2-4 appear to have similar means for BMI. Our ultimate question in this
Lab is whether or not the differences in means across groups are
statistically significant.</p>
<p><br></p>
</div>
<div id="b.-visualize-group-differences" class="section level3">
<h3>b. Visualize group differences</h3>
<p>As we saw in Lab 2, it is also useful to visualize distributions and
potential relationships using descriptive plots. Boxplots are
particularly useful when comparing the distribution of a continuous
random variable across levels of a categorical variable. We can
visualize the distribution of BMI across education levels as
follows:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Boxplot of BMI across attained education levels</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">boxplot</span>(data<span class="sc">$</span>BMI <span class="sc">~</span> data<span class="sc">$</span>EDUC, </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Boxplot of BMI by Education Level&quot;</span>, </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Education Level&quot;</span>, </span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;BMI&quot;</span>, </span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>, </span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>        <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;0-11 years&quot;</span>, <span class="st">&quot;High School&quot;</span>, <span class="st">&quot;Some College&quot;</span>, <span class="st">&quot;College degree or more&quot;</span>))</span></code></pre></div>
<p><img src="Lab_6_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>For a detailed breakdown of this code chunk and its output, please
revisit Lab 2.</p>
<p><br></p>
</div>
<div id="c.-check-for-extreme-outliers" class="section level3">
<h3>c. Check for extreme outliers</h3>
<p>Before conducting statistical analyses, it’s important to identify
outliers — values that are unusually high or low compared to the rest of
the data. Outliers can impact assumptions for hypothesis testing, such
as normality and homogeneity of variance in ANOVA.</p>
<p>We will use the <code>identify_outliers()</code> function from the
<code>rstatix</code> package to detect outliers in BMI across education
levels. This function flags observations as outliers based on the
interquartile range (IQR) method we learned in Lab 2, which classifies
an observation as an outlier if it falls more than 1.5 times the IQR
below the first quartile (Q1) or above the third quartile (Q3).</p>
<p>Additionally, we will look for <em>extreme outliers</em>, which are
values that fall more than 3 times the IQR beyond Q1 or Q3. Extreme
outliers are particularly important because they may indicate data entry
errors, measurement issues, or unusual cases that could
disproportionately influence ANOVA results. At this stage, we are only
identifying outliers. We will determine whether or not they need to be
addressed later when checking ANOVA assumptions.</p>
<p>In this step, we are storing the identified outliers for
<code>BMI</code> in a new object called <code>bmi_outliers</code>,
again, using the <code>identify_outliers()</code> function. Because we
are saving the output to an object, you won’t see any immediate results
in the Console after running the code:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># check for extreme outliers in BMI</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>bmi_outliers <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(EDUC) <span class="sc">%&gt;%</span> <span class="fu">identify_outliers</span>(BMI)</span></code></pre></div>
<p>To view the identified outliers, locate the <code>bmi_outliers</code>
object in the Environment window. When you click on the object, you
should see the dataset open in a new tab. We can also use the
<code>head()</code> function to view the top few rows in the Console as
follows:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># view top few rows of `bmi_outliers` object</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">head</span>(bmi_outliers)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 9
##   EDUC  RANDID SEX     AGE   BMI TOTCHOL OBESE is.outlier is.extreme
##   &lt;ord&gt;  &lt;int&gt; &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;   &lt;int&gt; &lt;fct&gt; &lt;lgl&gt;      &lt;lgl&gt;     
## 1 1      83398 1        52  40.1     178 1     TRUE       FALSE     
## 2 1     181634 2        45  45.8     183 1     TRUE       TRUE      
## 3 1     246478 2        66  40.5     278 1     TRUE       FALSE     
## 4 1     275208 2        41  42.2     265 1     TRUE       FALSE     
## 5 1     292084 2        46  36.8     200 1     TRUE       FALSE     
## 6 1     359422 2        57  38.4     266 1     TRUE       FALSE</code></pre>
<p>If you opt to click the <code>bmi_outliers</code> object (thereby
opening it in a new tab), you can sort the columns by clicking on the
column names. For example, if you want to see all of the extreme
outliers, click on the “is.extreme” column to sort by TRUE or FALSE.
This makes it easier to review the most influential outliers before
proceeding to check ANOVA assumptions in the next task.</p>
<p><br></p>
</div>
</div>
<div id="check-anova-assumptions" class="section level2">
<h2>6. Check ANOVA assumptions</h2>
<div id="a.-independence" class="section level3">
<h3>a. Independence</h3>
<p>The assumption of independence cannot be tested using statistical
methods in R. Instead, it is a study design issue, meaning that whether
this assumption holds depends on how the data were collected. The
independence assumption means that observations must not be
systematically related to one another. In other words, each
participant’s data should not be influenced by or dependent on another
participant’s data. If this assumption is violated, ANOVA results may be
misleading because dependencies between observations can artificially
reduce variability within groups and lead to incorrect conclusions. In
our case, if the Framingham Heart Study collected its data from
independent individuals (we will assume this is the case), the
assumption of independence is likely met by design, and we do not need
to check for it using statistical tests.</p>
<p><br></p>
</div>
<div id="b.-normality" class="section level3">
<h3>b. Normality</h3>
<p>The normality assumption in ANOVA requires that the dependent
variable (in this case, BMI) is approximately normally distributed
within each group (in this case, education level). While ANOVA is
somewhat robust to violations of normality, especially when sample sizes
are large, it is still good practice to check for normality before
proceeding.</p>
<p>There are two main approaches for assessing normality: (1)
statistical tests such as the <strong>Shapiro-Wilk Test for
Normality</strong>; and (2) <strong>visual methods</strong> such as
grouped histograms or Q-Q plots (Quantile-Quantile plots).</p>
<p><br></p>
<div id="shapiro-wilk-test-for-normality" class="section level4">
<h4>Shapiro-Wilk Test for Normality</h4>
<p>The Shapiro-Wilk test is one of the most commonly used statistical
tests for normality. It formally tests whether the data significantly
deviate from a normal distribution. The null hypothesis of the
Shapiro-Wilk test is that the data follow a normal distribution. We can
interpret the results of the Shapiro-Wilk test as follows:</p>
<ul>
<li>If the p-value &gt; 0.05, we fail to reject the null hypothesis,
meaning the data do not significantly deviate from normality (i.e., they
are approximately normal).</li>
<li>If the p-value &lt; 0.05, this suggests that the data deviate from
normality.</li>
</ul>
<p>We can apply the Shapiro-Wilk Test for our outcome of interest using
the <code>shapiro_test()</code> function as follows:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Check normality of BMI within each education level</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(EDUC) <span class="sc">%&gt;%</span> <span class="fu">shapiro_test</span>(BMI)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 4
##   EDUC  variable statistic        p
##   &lt;ord&gt; &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;
## 1 1     BMI          0.951 7.70e-25
## 2 2     BMI          0.971 2.73e-15
## 3 3     BMI          0.980 1.91e- 8
## 4 4     BMI          0.963 6.13e-10</code></pre>
<p>From the output, we can see our data violate the normality assumption
based on the Shaprio-Wilk Test (as the p-value for each group is very
small).</p>
<p>Importantly, the Shapiro-Wilk test is very sensitive to sample size,
where, for large samples (&gt; 100 per group), the test often detects
small, meaningless deviations from normality, even when these deviations
are not strong enough to affect ANOVA results. Thus, for large samples
(like ours), we often rely more on visual methods to assess normality
rather than strictly interpreting the p-value from the Shapiro-Wilk
test.</p>
<p><br></p>
</div>
<div id="visual-methods-to-check-normality" class="section level4">
<h4>Visual methods to check normality</h4>
<p>Once again, since statistical tests like the Shapiro-Wilk test can be
overly sensitive in large samples, visual methods provide a practical
alternative. We’ll focus on two visual approaches, grouped histograms
and Q-Q plots. We need to know whether the data are normally distributed
within each group, so we’ll have separate plots for each education
level.</p>
<p><br></p>
<div id="histograms" class="section level5">
<h5>Histograms</h5>
<p>Histograms are a useful way to visually assess whether deviations
from normality are meaningful or minor. If the histograms show severe
skewness or extreme outliers, we may need to consider transformations or
alternative statistical methods. When examining histograms, we’ll look
for the following:</p>
<ul>
<li><strong>Bell-shaped distribution</strong> – A roughly symmetric,
unimodal shape suggests that the data are approximately normally
distributed.</li>
<li><strong>Skewness</strong> – If the histogram is right-skewed (long
tail on the right) or left-skewed (long tail on the left), the normality
assumption may be violated.</li>
<li><strong>Peakedness (Kurtosis)</strong> – If the histogram is too
peaked (leptokurtic) or too flat (platykurtic) compared to a normal
distribution, this could indicate deviations from normality.</li>
<li><strong>Outliers or gaps</strong> – Large gaps, extreme values, or
multiple peaks (bimodal/multimodal distributions) suggest that the data
may not follow a normal distribution.</li>
</ul>
<p>We can generate a series of histograms for BMI - one for each
education level - using <code>ggplot</code> as follows:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Histogram of BMI for each education level</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> BMI, <span class="at">fill =</span> EDUC)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>EDUC, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span>  <span class="co"># Create separate histograms for each education level</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of BMI by Education Level&quot;</span>, <span class="at">x =</span> <span class="st">&quot;BMI&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Lab_6_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>A breakdown of this code chunk:</p>
<ul>
<li><code>ggplot(data, aes(x = BMI, fill = EDUC))</code>: Initializes
the plot using <code>ggplot()</code> and specifies <code>data</code> as
the dataset.
<ul>
<li><code>aes(x = BMI, fill = EDUC)</code>: Defines the aesthetic
mappings as follows:
<ul>
<li><code>x = BMI</code>: BMI values are plotted on the x-axis.</li>
<li><code>fill = EDUC</code>: Each education level is colored
differently.</li>
</ul></li>
</ul></li>
<li><code>geom_histogram(alpha = 0.6, bins = 30, position = "identity")</code>:
<ul>
<li><code>geom_histogram()</code>: Creates a histogram to visualize the
distribution of BMI.</li>
<li><code>bins = 30</code>: Specifies 30 bins (bars) for the histogram.
Adjusting this number changes the granularity of the distribution.</li>
<li><code>alpha = 0.6</code>: Sets the transparency level (opacity) of
the bars. A value of 0.6 makes overlapping bars slightly
transparent.</li>
<li><code>position = "identity"</code>: Stacks bars separately rather
than grouped together.</li>
</ul></li>
<li><code>facet_wrap(~EDUC, scales = "free")</code>: Facets the plot by
<code>EDUC</code>, meaning a separate histogram is created for each
education level.
<ul>
<li><code>scales = "free"</code> allows each facet to have its own
y-axis scale, particularly useful if group sizes differ, as in our
situation here.</li>
</ul></li>
<li><code>labs(title = "Distribution of BMI by Education Level", x = "BMI", y = "Frequency")</code>:
Adds labels to the plot as follows:
<ul>
<li><code>title = "Distribution of BMI by Education Level"</code>: Sets
the main title.</li>
<li><code>x = "BMI"</code>: X-axis label.</li>
<li><code>y = "Frequency"</code>: Y-axis label.</li>
</ul></li>
<li><code>theme_minimal()</code>: Applies a minimalistic theme to
improve readability.</li>
</ul>
<p><br></p>
<div id="interpretation" class="section level6">
<h6>Interpretation</h6>
<p>The histograms show the distribution of BMI across education levels,
where each panel represents a different education category. Overall, the
distributions appear approximately normal but with some right-skewness.
Additionally, the spread of BMI is fairly consistent across groups, but
education level 4 appears to have a slightly wider range of values,
suggesting greater variability at higher levels of education. There are
potential outliers on the higher end of the BMI distribution in each
group, which may require further investigation.</p>
<p><br></p>
</div>
</div>
<div id="q-q-plots" class="section level5">
<h5>Q-Q Plots</h5>
<p>While the histograms do not show severe deviations from normality, we
should confirm this by checking Q-Q plots (Quantile-Quantile plots),
another of the widely used visual methods to check the normality
assumption.</p>
<p>Q-Q plots essentially show how well the data in each group align with
a theoretical normal distribution. Ideally, if the data were perfectly
normal, the points would closely follow a diagonal reference line in
each panel. For example:</p>
<p><img src="qq-plot-interp.png" width="100%" /></p>
<p>To generate the Q-Q plots for BMI across education level, we will
again use <code>ggplot()</code> but specify some different options than
those used to generate the histograms above:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Q-Q Plot for BMI by Education Level</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">sample =</span> BMI)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>EDUC) <span class="sc">+</span> </span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Q-Q Plots for BMI by Education Level&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Lab_6_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Let’s break down this code chunk:</p>
<ul>
<li><code>ggplot(data, aes(sample = BMI))</code>: Initializes the plot
using the object called <code>data</code>.
<ul>
<li><code>aes(sample = BMI)</code>: Specifies that BMI values will be
plotted against a theoretical normal distribution.</li>
</ul></li>
<li><code>stat_qq()</code>: Adds a Q-Q plot layer, which plots the
quantiles of BMI data against the quantiles of a theoretical normal
distribution. If BMI is normally distributed, points should fall along a
straight line.</li>
<li><code>stat_qq_line()</code>: Adds a reference line representing a
perfectly normal distribution. If points closely follow this line, the
data are approximately normal. Deviations, especially at the tails,
indicate skewness (i.e., potential normality violations).</li>
<li><code>facet_wrap(~EDUC)</code>: Creates separate Q-Q plots for each
education level, allowing us to visually assess normality within each
group.</li>
<li><code>labs(title = "Q-Q Plots for BMI by Education Level")</code>:
Adds a title to the plot.</li>
<li><code>theme_minimal()</code>: Applies a minimalistic theme to the
plot.</li>
</ul>
<p><br></p>
<div id="interpretation-1" class="section level6">
<h6>Interpretation</h6>
<p>Overall, the Q-Q plots for BMI by education level suggest mild to
moderate deviations from normality, particularly at the upper ends of
the distributions. For all education levels (1 through 4), the points
generally follow the line in the middle range of the data but deviate at
the tails, indicating right-skewness. This is evident from the way the
upper quantiles curve upward away from the line, showing that there are
more high BMI values (or more extreme high values) than would be
expected under normality.</p>
<p>Since ANOVA assumes normality within groups, these mild to moderate
deviations might affect the validity of ANOVA results (particularly if
you are working with small sample sizes). The normality assumption is
less critical for large sample sizes, as ANOVA is relatively robust to
normality violations if group sizes are similar and reasonably large
(e.g., n&gt;30 per group).</p>
<p>There are several options for dealing with mild or moderate
deviations from normality. For example, we can consider <strong>variable
transformations</strong>. Variable transformations involve applying a
mathematical function to a variable in order to change its distribution.
Transformations are commonly used in statistical analysis when data
violate assumptions. The goal is to make the data more suitable for
analysis while preserving its variability and interpretability. A few
common variable transformations are as follows:</p>
<ul>
<li><strong>Log transformation</strong>: Useful when data are moderately
right-skewed.</li>
<li><strong>Square root transformation</strong>: Also an option when
data are moderately right-skewed.</li>
<li><strong>Cube root transformation</strong>: Can be useful for either
right- or left-skewed data.</li>
</ul>
<p>Since BMI is moderately right-skewed, we will apply a square root
transformation to see if this improves the normality of the data. To
carry out a square root transformation, we simply create a new variable
for the square root of BMI, which we will call <code>BMI_sqrt</code>,
using the <code>mutate()</code> and <code>sqrt()</code> functions, as
follows:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># create a new variable for square root of BMI</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">BMI_sqrt =</span> <span class="fu">sqrt</span>(BMI))</span></code></pre></div>
<p>Let’s take a look at a few rows of our data using the
<code>head()</code> function to ensure the square root-transformed BMI
variable was added to our dataset correctly, as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># view the top rows of dataset</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##   RANDID SEX AGE   BMI TOTCHOL EDUC OBESE BMI_sqrt
## 1   2448   1  39 26.97     195    4     0 5.193265
## 2   6238   2  46 28.73     250    2     0 5.360037
## 3   9428   1  48 25.34     245    1     0 5.033885
## 4  10552   2  61 28.58     225    3     0 5.346027
## 5  11252   2  46 23.10     285    3     0 4.806246
## 6  11263   2  43 30.30     228    2     1 5.504544</code></pre>
<p>From the output, we can see the variable <code>BMI_sqrt</code> has
been added to the dataset. Now that we have carried out this
transformation, let’s recreate the histograms and Q-Q plots to see
whether the normality assumption is met with this new variable.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Histogram of square root-transformed BMI for each education level</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> BMI_sqrt, <span class="at">fill =</span> EDUC)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>EDUC, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span>  <span class="co"># Create separate histograms for each education level</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of square root BMI by Education Level&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Square root of BMI&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Lab_6_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>The new histograms in the Plots window suggest that the square
root-transformed BMI variable (called <code>BMI_sqrt</code>) values
follow an approximately normal distribution across all education levels.
While some potential outliers remain, particularly in education level 4,
they appear more symmetrically distributed around the central bulk of
the data. Overall, the square root transformation has improved
normality, making the new variable better suited for subsequent
analyses.</p>
<p>Note that our ultimate goal has not changed - we are still
investigating differences in BMI by education level. The square root
transformation does not change the fundamental relationships between
groups; it just makes the data more suitable for statistical analysis.
When we interpret results, we can still describe differences in terms of
BMI, and if needed, we can back-transform values to the original scale
for clearer interpretation.</p>
<p>Next, let’s recreate the Q-Q plots using the square root-transformed
BMI variable, as follows:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Q-Q Plot for square root-transformed BMI by Education Level</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">sample =</span> BMI_sqrt)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>EDUC) <span class="sc">+</span> </span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Q-Q Plots for square root-transformed BMI by Education Level&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Lab_6_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>As with the histograms, the Q-Q plots for square root-transformed BMI
by education level show a general improvement in normality compared to
the original Q-Q plots. While there are still some minor deviations from
the reference line in all four education levels, the points generally
follow the diagonal reference line. This suggests that while some
potential outliers remain, their influence has been reduced compared to
the original (untransformed) BMI data. Given these improvements, we
should proceed with the square root- transformed BMI variable in our
subsequent steps.</p>
<p><br></p>
</div>
</div>
</div>
</div>
<div id="c.-homogeneity-of-variance" class="section level3">
<h3>c. Homogeneity of Variance</h3>
<p>The homogeneity of variance assumption (also called homoscedasticity)
is important for ANOVA because it ensures that the variability of the
dependent variable (now <code>BMI_sqrt</code>) is similar across all
education levels. If variance differs significantly between groups, it
can affect the accuracy of the ANOVA results, potentially leading to
incorrect conclusions. To assess this assumption, we will use
<strong>Levene’s test</strong>, which checks whether the variances are
equal across groups. If the test is not significant (p&gt;0.05), we can
assume that the variances are roughly equal and proceed with ANOVA.
However, if the test is significant (p&lt;0.05), we may need to adjust
our approach by using <strong>Welch’s ANOVA</strong>, which does not
assume equal variances.</p>
<p>We can carry out Levene’s Test as follows:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Levene&#39;s Test (this function is from the `rstatix` package)</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(BMI_sqrt <span class="sc">~</span> EDUC)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##     df1   df2 statistic           p
##   &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1     3  4430      10.3 0.000000982</code></pre>
<p>From the output, we can see that p&lt;0.05, meaning we reject the
null hypothesis of equal variances. Since Levene’s test indicates a
violation of the homoscedasticity assumption, we will use Welch’s ANOVA
instead of the standard ANOVA approach. Welch’s ANOVA is a modified
version of ANOVA that does not assume equal variances across groups,
making it more reliable when group variances differ.</p>
<p>This approach is similar to what we did in Labs 4 and 5, where we
used Welch’s t-test instead of the standard t-test when comparing two
groups with unequal variances. Just like Welch’s t-test adjusts for
differences in variance between two groups, Welch’s ANOVA adjusts for
variance differences across multiple groups. By using this method, we
can still compare mean values of square root-transformed BMI
(<code>BMI_sqrt</code>) across education levels while ensuring that our
results remain valid.</p>
<p><br></p>
</div>
</div>
<div id="perform-anova-procedure-in-this-case-welchs-anova"
class="section level2">
<h2>7. Perform ANOVA procedure (in this case, Welch’s ANOVA)</h2>
<p>Now that we have checked assumptions, we can move onto our actual
ANOVA procedure (or in this case, Welch’s ANOVA, using the
<code>welch_anova_test()</code> function) to test for differences in
mean BMI across education levels, as follows:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Perform Welch&#39;s ANOVA</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>welch_results <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">welch_anova_test</span>(BMI_sqrt <span class="sc">~</span> EDUC)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="fu">print</span>(welch_results)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 7
##   .y.          n statistic   DFn   DFd        p method     
## * &lt;chr&gt;    &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      
## 1 BMI_sqrt  4434      43.0     3 1683. 8.65e-27 Welch ANOVA</code></pre>
<p>Recall from the introduction above that the null hypothesis for ANOVA
(and Welch’s ANOVA) is that the means across groups are equal. Since the
test produces a p-value of 8.65e-27 (i.e., very close to 0), this
suggests <em>at least one</em> education level has a significantly
different mean BMI - meaning education level may be associated with
differences in BMI. Because we obtained a significant result, we need to
conduct post-hoc tests to determine which groups differ from each
other.</p>
<p>Before we move on to post-hoc tests, a quick note that, if Levene’s
test had returned an insignificant result (i.e., p&gt;0.05), we would
have carried out the standard ANOVA test rather than Welch’s ANOVA. In
the event that you need to use the standard ANOVA approach, you would
use the <code>anova_test()</code> function and set up the code as
follows:</p>
<pre><code># Perform standard ANOVA test
anova_results &lt;- data %&gt;% anova_test(BMI_sqrt ~ EDUC)
print(anova_results)</code></pre>
<p><br></p>
</div>
<div id="carry-out-post-hoc-tests-for-pairwise-comparisons"
class="section level2">
<h2>8. Carry out post-hoc tests for pairwise comparisons</h2>
<p>When conducting post-hoc tests for pairwise comparisons following
ANOVA (or Welch’s ANOVA), the choice of test depends on whether the
assumption of equal variances is met and whether group sizes are equal
or unequal. Each test is designed to compare pairwise differences
between group means while controlling for the increased risk of Type I
error that otherwise comes with multiple comparisons. Our options are as
follows:</p>
<ul>
<li><strong>Tukey’s Honest Significant Difference (Tukey HSD)
test</strong> is the most commonly used post-hoc test when the
assumption of equal variances holds and group sizes are roughly equal.
It systematically compares all possible pairs of group means and adjusts
for multiple comparisons to ensure that the overall Type I error rate is
controlled. If Levene’s test confirms equal variances, Tukey HSD is a
valid choice. However, it is not appropriate when variance differs
significantly across groups, as this can inflate error rates. Since our
scenario here violates assumption of equal variances, and we have
different sample sizes across education levels, Tukey’s HSD test is not
appropriate. However, if you do need to use it at any point, the syntax
is as follows:</li>
</ul>
<pre><code># Run Tukey’s HSD post-hoc test for pairwise comparisons
data %&gt;% tukey_hsd(BMI_sqrt ~ EDUC)</code></pre>
<ul>
<li><p>A variation of Tukey’s HSD test, the <strong>Tukey-Kramer
test</strong>, is used when variances are equal, but group sizes are
unequal. While the standard Tukey’s HSD test assumes that sample sizes
are similar, the Tukey-Kramer adjustment corrects for differences in
sample sizes, making it a better alternative when group sizes vary. Like
Tukey’s HSD, it assumes homogeneity of variance, so it should only be
used when Levene’s test indicates that variances are approximately equal
across groups. To run the Tukey-Kramer test in R, we would actually use
the exact same code as shown above for Tukey’s HSD test. R will detect
that the sample sizes are different and automatically adapt by using the
Tukey-Kramer correction for unequal sample sizes. Neat!</p></li>
<li><p>Finally, when variances are unequal, as indicated by a
significant result from Levene’s test, the <strong>Games-Howell
test</strong> is the preferred approach. Unlike Tukey’s HSD,
Games-Howell does not assume equal variances and adjusts for both
variance and sample size differences. This makes it the best choice when
analyzing data that violates the homogeneity of variance assumption.
This means the Games-Howell test is the appropriate post-hoc procedure
following use of Welch’s ANOVA. Given that our Levene’s test showed
unequal variances, and we used Welch’s ANOVA to detect differences
across the four groups, we will proceed with the Games-Howell post-hoc
test for pairwise comparisons, as follows:</p></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># Run Games-Howell post-hoc test for pairwise comparisons</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>ght_results <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">games_howell_test</span>(BMI_sqrt <span class="sc">~</span> EDUC)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="fu">print</span>(ght_results)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
##   .y.      group1 group2 estimate conf.low conf.high    p.adj p.adj.signif
## * &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       
## 1 BMI_sqrt 1      2      -0.123    -0.160    -0.0868 0        ****        
## 2 BMI_sqrt 1      3      -0.154    -0.195    -0.113  0        ****        
## 3 BMI_sqrt 1      4      -0.126    -0.174    -0.0794 5.28e-11 ****        
## 4 BMI_sqrt 2      3      -0.0308   -0.0731    0.0115 2.41e- 1 ns          
## 5 BMI_sqrt 2      4      -0.00322  -0.0516    0.0452 9.98e- 1 ns          
## 6 BMI_sqrt 3      4       0.0276   -0.0241    0.0793 5.17e- 1 ns</code></pre>
<p>After running the Games-Howell post-hoc test, the output will display
a table in which each row represents a <strong>pairwise
comparison</strong> between two education levels (e.g., EDUC 1 vs. EDUC
2). The columns of our output are as follows:</p>
<ol style="list-style-type: decimal">
<li><strong>group 1</strong> and <strong>group 2</strong> – The two
groups (in this case, education levels) being compared.</li>
<li><strong>estimate</strong> – The estimated difference in means
between the two groups (group 2 – group 1).</li>
<li><strong>conf. low</strong> and <strong>conf. high</strong> – The 95%
confidence interval for the difference in means.</li>
<li><strong>p.adj</strong> – The p-value. Determines statistical
significance, where p&lt;0.05 indicates a significant difference between
the two groups.</li>
<li><strong>p.adj.signif</strong> – An indicator of whether the test
returned a significant result, where “ns” means “not significant.”</li>
</ol>
<p><br></p>
<div id="interpretation-2" class="section level6">
<h6>Interpretation</h6>
<p>Our results indicate significant differences in square
root-transformed BMI (<code>BMI_sqrt</code>) between education level 1
and all other education levels (2, 3, and 4), as shown by the p-values
(&lt;0.05) and confidence intervals that do not include zero.
Specifically, individuals in education level 1 have significantly
greater square root-transformed BMI values compared to levels 2, 3, and
4. However, no significant differences were found between education
levels 2 and 3 (p = 0.241), 2 and 4 (p = 0.998), or 3 and 4 (p = 0.517),
based on the p-values and as their confidence intervals contain zero.
These findings suggest that education level 1 differs from the others,
while the remaining education levels have comparable BMI values.</p>
<p>From a public health standpoint, these findings suggest that
individuals with lower educational attainment (less than high school)
have significantly greater BMI compared to those with higher education
levels within the Framingham population, which may contribute to
socioeconomic disparities in long-term cardiovascular outcomes.</p>
<p><br></p>
</div>
</div>
<div id="visualize-results" class="section level2">
<h2>9. Visualize results</h2>
<p>After carrying out pairwise comparisons, it can be helpful to
visualize results to more easily communicate our findings – particularly
when we want to prepare graphics for publication or presentation to
others. We can visualize the results of the Games-Howell test as
follows:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># visualize results</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>ght_results <span class="ot">&lt;-</span> ght_results <span class="sc">%&gt;%</span> <span class="fu">add_xy_position</span>(<span class="at">x =</span> <span class="st">&quot;EDUC&quot;</span>)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="fu">ggboxplot</span>(data, <span class="at">x =</span> <span class="st">&quot;EDUC&quot;</span>, <span class="at">y =</span> <span class="st">&quot;BMI_sqrt&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="fu">stat_pvalue_manual</span>(ght_results, <span class="at">hide.ns =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">get_test_label</span>(welch_results, <span class="at">detailed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">get_pwc_label</span>(ght_results)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="Lab_6_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>This code chunk essentially recreates the boxplot figure we examined
in our exploratory data analysis up above – but now, we’re showing the
square root-transformed BMI variable used in our analysis, and we’ve
added indicators – based on the results of the Games-Howell test – of
which pairwise comparisons were statistically significant.</p>
<p><br></p>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>In Lab 6, we have learned essential steps for carrying out the
Analysis of Variance (ANOVA) procedure to investigate differences in
means across more than two groups. Any analysis such as this should
follow this general process:</p>
<ol style="list-style-type: decimal">
<li>Begin with exploratory data analysis, including calculation of
summary statistics and visualization with descriptive plots, to
understand distributions and explore potential relationships between
variables of interest.</li>
<li>Check ANOVA assumptions, including normality and homogeneity of
variance (or homoscedasticity) using statistical tests and visual
approaches.</li>
<li>If appropriate, perform the ANOVA procedure (or Welch’s ANOVA, in
the case of unequal variances).</li>
<li>If the ANOVA or Welch’s ANOVA test results in a significant result,
carry out the appropriate post-hoc test for pairwise comparisons.</li>
<li>Report and visualize results.</li>
</ol>
<p>This ANOVA procedure allows us to understand the relationship between
a categorical independent variable and continuous dependent variable.
Next week, we will extend this idea by introducing simple linear
regression, which typically examines the relationship between a
continuous independent variable and a continuous dependent variable.</p>
<p>When you are ready, please submit the following to the Lab 6
assignment page on Canvas:</p>
<ol style="list-style-type: decimal">
<li>An R Markdown document, which has a <code>.Rmd</code> extension</li>
<li>A knitted <code>.html</code> file</li>
</ol>
<p>Please reach out to me at <a href="mailto:jenny.wagner@csus.edu"
class="email">jenny.wagner@csus.edu</a> if you have any questions. See
you in class!</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
