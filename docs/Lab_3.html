<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lab 3: Probability Distributions</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PUBH 207B: Spring 2025</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="course_schedule.html">Course Schedule</a>
</li>
<li>
  <a href="install.html">Getting Started</a>
</li>
<li>
  <a href="about.html">Assignment Guidelines</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lab Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lab_1.html">Lab 1</a>
    </li>
    <li>
      <a href="Lab_2.html">Lab 2</a>
    </li>
    <li>
      <a href="Lab_3.html">Lab 3</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Lab 3: Probability Distributions</h1>

</div>


<p><br></p>
<p><strong>Jenny Wagner, PhD, MPH</strong> <br> Department of Public
Health <br> California State University, Sacramento <br> <br></p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Probability distributions are a fundamental concept in statistics and
public health research. They describe how the values of a random
variable are distributed, information which gives us a mathematical
framework to quantify uncertainty and make predictions about data. In
simpler terms, a probability distribution shows the likelihood of
different outcomes for a given variable. In the real world, they are
used to describe patterns in health-related data - for example, the
distribution of disease incidence, patient wait times, or the
effectiveness of interventions.</p>
<p>There are two main types of probability distributions, discrete and
continuous probability distributions, discussed below.</p>
<p><br></p>
<div id="discrete-probability-distributions" class="section level2">
<h2>Discrete Probability Distributions</h2>
<p>Discrete probability distributions are used for variables that can
take on a <em>finite or countable</em> number of distinct values (i.e.,
for discrete random variables). Each value has a specific probability
associated with it. For example, the number of new cases of a disease
reported in a week is a discrete variable, as it represents a count
(e.g., 0, 1, 2, …). We will focus on two commonly used discrete
probability distributions:</p>
<ul>
<li><strong>Binomial Distribution:</strong> Models the probability of a
specific number of “successes” in a fixed number of independent trials,
where each trial has the same probability of success. For example, we
might use the binomial distribution to estimate the probability of a
certain number of patients recovering after a new treatment or to
predict the proportion of smokers in a sample of adults.</li>
<li><strong>Poisson Distribution:</strong> Models the probability of a
given number of events occurring in a fixed interval of time and space,
assuming the events happen independently and at a constant average rate.
For example, we might use the Poisson distribution to model the number
of emergency room visits in a day or estimate the number of disease
outbreaks in a year in a specific region.</li>
</ul>
<p><br></p>
</div>
<div id="continuous-probability-distributions" class="section level2">
<h2>Continuous Probability Distributions</h2>
<p>Continuous probability distributions are used for variables that can
take on an <em>infinite number of values</em> within a given range
(i.e., for continuous random variables). Probabilities are represented
as areas under a curve, as the probability of any single exact value is
effectively zero (because, again, these variables can take on an
infinite number of values). For example, body mass index (BMI) is a
continuous variable, as it can take on any value within a realistic
range (e.g., 18.5, 24.7). The most commonly used continuous probability
distribution is the Normal distribution, which is widely used to model
data in public health and is considered the most important probability
distribution in statistics.</p>
<ul>
<li><strong>Normal Distribution:</strong> A continuous probability
distribution characterized by a symmetric, bell-shaped curve. It is
defined by its mean, which determines the center of the distribution,
and standard deviation, which determines its spread. The normal
distribution is often used to analyze continuous health metrics (e.g.,
BMI, cholesterol levels, blood pressure, etc.) and serves as the
foundation for many statistical methods, including confidence interval
estimation and hypothesis testing.</li>
</ul>
<p>A solid understanding of probability distributions will be important
a we move toward statistical methods like estimation and hypothesis
testing in the coming weeks.</p>
<p><br></p>
</div>
</div>
<div id="objectives" class="section level1">
<h1>Objectives</h1>
<p>After completing Lab 3, you will be able to:</p>
<ol style="list-style-type: decimal">
<li>Construct and interpret a discrete probability distribution.</li>
<li>Calculate probabilities using discrete and continuous probability
distributions for public health scenarios.</li>
<li>Calculate measures of center and spread for discrete probability
distributions.</li>
<li>Visualize discrete and continuous probability distributions.</li>
</ol>
<p><br></p>
</div>
<div id="tasks" class="section level1">
<h1>Tasks</h1>
<p>Lab 3 is divided into two parts. <strong>Part 1</strong> focuses on
discrete probability distributions based on <em>real data</em>, like the
example discussed in this week’s lecture video. For Part 1 you will use
the dataset called “substances.csv” which you can download from Canvas.
<strong>Part 2</strong> focuses on theoretical probability distributions
- specifically, the Binomial, Poisson, and Normal distributions. For
Part 2 you will not need any data files. Rather, we will apply R
functions that already contain information about these theoretical
distributions to given public health scenarios.</p>
<p>When you are ready to start Lab 3:</p>
<ol style="list-style-type: decimal">
<li>First create a new R Markdown file using the instructions on the
Assignment Guidelines page. Save this <code>.Rmd</code> file in a folder
dedicated to Lab 3 materials.</li>
<li>Next, download and save the dataset called “substances.csv” in the
same folder as your Lab 3 R Markdown file.</li>
<li>Finally, proceed to read through and carry out each of the tasks
detailed below. As usual, you will begin by loading R packages, setting
your working directory, and importing the dataset.</li>
</ol>
<p><br></p>
<div id="part-1-discrete-probability-distributions-based-on-real-data"
class="section level2">
<h2>Part 1: Discrete Probability Distributions Based on Real Data</h2>
<p>Part 1 is based on the following scenario: Suppose patients who were
involved in a problem gambling treatment program were surveyed about
co-occurring drug and alcohol addictions. Let the discrete random
variable ‘X’ represent the number of co-occurring addictive substances
used by the subjects. The dataset labeled “substances.csv” contains two
variables:</p>
<ol style="list-style-type: decimal">
<li>A study ID number corresponding to each individual patient.</li>
<li>The number of substances used by the corresponding patient.</li>
</ol>
<p><br></p>
<div id="install-and-load-r-packages" class="section level3">
<h3>1. Install and load R packages</h3>
<p>In this Lab we will continue to work with functions contained within
the ‘tidyverse’ package. We will also use functions from the ‘stats’
package, which may be new for you. If you have not previously installed
this package, copy and paste the following into your Console
(bottom-left window), then click Enter or Return to execute the
code:</p>
<pre><code>install.packages(&quot;stats&quot;)</code></pre>
<p>Once you have installed the new package, load the required packages
using the <code>library()</code> function as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(stats)</span></code></pre></div>
<p><br></p>
</div>
<div id="set-your-working-directory" class="section level3">
<h3>2. Set your working directory</h3>
<p>Set your working directory using the <code>setwd()</code> function
(see Assignment Guidelines for detailed instructions).</p>
<pre><code>setwd(&quot;YOUR FILE PATH HERE&quot;)</code></pre>
<p><br></p>
</div>
<div id="import-the-dataset-into-rstudio" class="section level3">
<h3>3. Import the dataset into RStudio</h3>
<p>Use the <code>read.csv()</code> function to import the
“substances.csv” data file. Remember that this file must be saved in the
working directory you specified in the above step.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># import dataset</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;substances.csv&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>X)</span></code></pre></div>
<p><em>Note:</em> Sometimes when importing a CSV file into RStudio, a
column called ‘X’ is added to the dataset to identify the observation
number. My personal preference is to drop this column, which is what the
<code>%&gt;% select(-X)</code> part of the code above is doing. If you
ever notice that an ‘X’ column is added to your dataset, you can use the
same code to remove it. But again, this is a personal preference. We
could choose leave the ‘X’ column in the dataset if we wanted to; it’s
not hurting anything.</p>
<p>After running the above code chunk, you should see an object called
<code>data</code> in your Environment window with 777 observations and 2
variables (defined above).</p>
<p><br></p>
</div>
<div id="construct-a-discrete-probability-distribution"
class="section level3">
<h3>4. Construct a discrete probability distribution</h3>
<p>To construct a discrete probability distribution for the number of
co-occurring substance addictions, we first need to create a table
showing the <em>frequency</em> and <em>relative frequency</em> for this
discrete distribution as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># construct frequency table and save it as a new dataframe</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>subs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(data<span class="sc">$</span>substances))</span></code></pre></div>
<p>A brief breakdown of this code:</p>
<ul>
<li><code>table(data$substances)</code>: Creates a frequency table of
the substances variable in the data dataset. The table counts the
occurrences of each unique value in the <code>substances</code>
variable, producing a summary of how often each substance appears.</li>
<li><code>as.data.frame()</code>: Stores the frequency table as an
object in our Environment with two columns: one column for the unique
values in substances and another column for their respective
counts.</li>
<li><code>subs &lt;- ...</code>: Names the resulting object
<code>subs</code>. The <code>subs</code> object will now contain two
columns where:
<ul>
<li>The first column (generically called <code>Var1</code>) holds the
unique values of the substances variable.</li>
<li>The second column (<code>Freq</code>) holds the corresponding
frequencies (counts) of those values.</li>
</ul></li>
</ul>
<p>Let’s click on the <code>subs</code> object in our Environment to see
what it looks like. We can also use the <code>print()</code> command as
follows to show the table in the Console (bottom-left) window:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># print frequency table</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">print</span>(subs)</span></code></pre></div>
<pre><code>##    Var1 Freq
## 1     0  144
## 2     1  342
## 3     2  142
## 4     3   72
## 5     4   39
## 6     5   20
## 7     6    6
## 8     7    9
## 9     8    2
## 10    9    1</code></pre>
<p>As expected, we see two variables, <code>Var1</code> (the number of
co-occurring substances) and <code>Freq</code> (the number of people in
our dataset with each correponding number of co-occurring
substances).</p>
<p>When constructing a discrete probability distribution, the goal is to
represent the likelihood of each category or value in the dataset. To do
this, we need to calculate <strong>relative frequencies</strong>, which
represent the proportion of occurrences for each category relative to
the total number of observations. For our scenario here, this means
calculating the relative frequency of each number of co-occurring
substances by dividing the frequency in each category by the total
number of observations. We can create a new variable for the relative
frequencies in our <code>subs</code> object as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># create a new variable for the relative frequency </span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>    <span class="co"># relative frequency = the proportion of subjects with each number of substances used</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>subs <span class="ot">&lt;-</span> subs <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rel_freq =</span> Freq<span class="sc">/</span>(<span class="fu">sum</span>(Freq)))</span></code></pre></div>
<p>This line of code creates a new variable called <code>rel_freq</code>
using the frequencies generated previously. A more detailed
explanation:</p>
<ul>
<li><code>subs</code>: This is the data frame being modified. It
contains a frequency table where one column (Freq) holds the counts for
each category.</li>
<li><code>subs %&gt;%</code>: Passes the <code>subs</code> object, which
contains the frequency table, through the mutate function. Remember, the
pipe operator (we’ve seen this several times now!) is like saying “and
then”. We are telling R, “use the data in the object <code>subs</code>
<em>and then</em> create a new variable with the <code>mutate()</code>
function.”</li>
<li><code>mutate()</code>: A function used to create new variables or
modify existing ones in a data frame. In this case, it adds a new column
called <code>rel_freq</code> to the <code>subs</code> data frame.</li>
<li><code>rel_freq = Freq / (sum(Freq))</code>:
<ul>
<li><code>Freq</code>: Refers to the column in subs that holds the raw
frequencies (counts) of each category.</li>
<li><code>sum(Freq)</code>: Calculates the total frequency (i.e., the
sum of all counts in the Freq column).</li>
<li><code>Freq / (sum(Freq))</code>: Divides each frequency value by the
total frequency to compute the relative frequency for each category.
This gives the proportion of the total observations that fall into each
category.</li>
</ul></li>
<li><code>subs &lt;-</code>: Reassigns the modified data frame back to
the subs object, updating it with the new rel_freq column.</li>
</ul>
<p>Let’s again use the <code>print()</code> command to view the updated
table as follows:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># print frequency table</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">print</span>(subs)</span></code></pre></div>
<pre><code>##    Var1 Freq    rel_freq
## 1     0  144 0.185328185
## 2     1  342 0.440154440
## 3     2  142 0.182754183
## 4     3   72 0.092664093
## 5     4   39 0.050193050
## 6     5   20 0.025740026
## 7     6    6 0.007722008
## 8     7    9 0.011583012
## 9     8    2 0.002574003
## 10    9    1 0.001287001</code></pre>
<p>As expected, we see a new variable, <code>rel_freq</code>, which
tells us the relative frequency (or proportion) of the sample with each
corresponding number of co-occurring substance addictions.</p>
<p><br></p>
<p>Next, let’s visualize this probability distribution using the
<code>barplot</code> function:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># generate a simple bar chart for sex</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">barplot</span>(subs<span class="sc">$</span>rel_freq, </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Number of co-occurring substance addictions&quot;</span>, </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Relative frequency&quot;</span>, </span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>        <span class="at">names.arg =</span> subs<span class="sc">$</span>Var1)</span></code></pre></div>
<p><img src="Lab_3_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Visualizing the probability distribution in this way allows us to
quickly see the most and least likely outcomes.</p>
<p><br></p>
</div>
<div
id="calculate-probabilities-from-a-discrete-probability-distribution"
class="section level3">
<h3>5. Calculate probabilities from a discrete probability
distribution</h3>
<p>When we created the <code>subs</code> object, the discrete random
variable ‘X’ (currently labeled <code>Var1</code>) defaulted to a factor
variable. In previous Labs we have converted numeric variables to
factors. Here, however, it will be helpful to convert <code>Var1</code>
from a factor variable to a numeric variable, since we know the values
represent quantities - the number of co-occurring substance addictions -
not categories. Converting <code>Var1</code> to a numeric variable will
ensure it is treated appropriately in our analyses.</p>
<p>We need to use a two-step process to convert a factor variable to a
numeric variable. We first need to convert the factor variable to a
“character” variable - basically, text - using the
<code>as.character()</code> function, then to a numeric variable using
the <code>as.numeric()</code> function. Very strange, I know. If we do
not first convert to a character variable, R will drop the category
corresponding to zero co-occurring substances, and we don’t want that to
happen.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># convert factor to numeric variable</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>subs<span class="sc">$</span>Var1 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(subs<span class="sc">$</span>Var1) <span class="co"># first convert to character </span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>subs<span class="sc">$</span>Var1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(subs<span class="sc">$</span>Var1)</span></code></pre></div>
<p>Now that we have formatted our variables appropriately, we can
calculate probabilities for specified numbers of co-occurring substance
addictions. For example, suppose we want to know the probability that an
individual selected at random uses exactly five addictive substances.
For a specific number of co-occurring substances (in this case, 5), we
can find this answer by looking directly at our discrete probability
distribution. When we look at the row where <code>Var1</code> is equal
to 5, we see that <code>rel_freq</code> is equal to 0.025740026. This
means that the probability a randomly selected person from the sample
has 5 co-occurring substance addictions is 0.025740026, or about
2.6%.</p>
<p>When we want to know the probability associated with one particular
value of our discrete random variable, it is easy enough to use this
approach of looking at the table of relative frequencies. However, if we
want to know the probability associate with a range of values, the most
efficient method is to use code. Let’s walk through a few examples…</p>
<p><br></p>
<div
id="a.-what-is-the-probability-that-an-individual-selected-at-random-used-fewer-than-three-addictive-substances"
class="section level4">
<h4>a. What is the probability that an individual selected at random
used <em>fewer than three</em> addictive substances?</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># obtain the probability of fewer than 3 co-occurring substance addictions</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>subs <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Var1 <span class="sc">&lt;</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">sum</span>(rel_freq))</span></code></pre></div>
<pre><code>##   sum(rel_freq)
## 1     0.8082368</code></pre>
<p>Here, we are taking the <em>sum of relative frequencies</em> where
<code>Var1</code> is less than 3. A brief breakdown of this line of
code:</p>
<ul>
<li><code>subs %&gt;%</code>: The pipe operator <code>%&gt;%</code>
passes the <code>subs</code> object, which contains the probability
distributions, to the next function in sequence.</li>
<li><code>filter(Var1 &lt; 3)</code>: Filters the dataset, keeping only
the rows where the <code>Var1</code> column has values less than 3
(i.e., rows where <code>Var1</code> is equal to 0, 1, or 2 will be
retained).</li>
<li><code>summarise(sum(rel_freq))</code>: The summarise() function
creates a summary statistic for the filtered data. By nesting
<code>sum(rel_freq)</code> within the <code>summarise()</code> function,
we obtain the sum of the <code>rel_freq</code> column (relative
frequencies) for the filtered subset.</li>
</ul>
<p>From the output in our Console window, we find the probability that a
randomly selected person from the sample uses fewer than 3 addictive
substances is 0.8082368, or about 80.8%.</p>
<p><br></p>
</div>
<div
id="b.-what-is-the-probability-that-an-individual-selected-at-random-used-more-than-six-addictive-substances"
class="section level4">
<h4>b. What is the probability that an individual selected at random
used <em>more than six</em> addictive substances?</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>subs <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Var1 <span class="sc">&gt;</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">sum</span>(rel_freq))</span></code></pre></div>
<pre><code>##   sum(rel_freq)
## 1    0.01544402</code></pre>
<p>Here, we are taking the sum of relative frequencies where
<code>Var1</code> is greater than 6. We find the probability that a
randomly selected person from the sample uses greater than 6 addictive
substances is 0.01544402, or about 1.5%.</p>
<p><strong>Note:</strong> In part (a) we filtered for values of
<code>Var1</code> less than 3, while here we are filtering for values of
<code>Var1</code> greater than 6. Otherwise the code is exactly the
same.</p>
<p><br></p>
</div>
<div
id="c.-what-is-the-probability-that-an-individual-selected-at-random-used-between-2-and-5-addictive-substances"
class="section level4">
<h4>c. What is the probability that an individual selected at random
used <em>between 2 and 5</em> addictive substances?</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>subs <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Var1 <span class="sc">&gt;=</span> <span class="dv">2</span> <span class="sc">&amp;</span> Var1 <span class="sc">&lt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">sum</span>(rel_freq))</span></code></pre></div>
<pre><code>##   sum(rel_freq)
## 1     0.3513514</code></pre>
<p>This one is a little trickier. Here, we are taking the sum of
relative frequencies where <code>Var1</code> is both greater than or
equal to 2 <em>and</em> less than or equal to 5 (in other words, where
<code>Var1</code> is between 2 and 5, inclusive). We find the
probability that a randomly selected person from the sample uses between
2 and 5 addictive substances is 0.3513514, or about 35.1%.</p>
<p><br></p>
</div>
</div>
<div
id="calculate-measures-of-center-and-spread-for-a-discrete-probability-distribution"
class="section level3">
<h3>6. Calculate measures of center and spread for a discrete
probability distribution</h3>
<p>Measures of center and spread are useful for summarizing and
interpreting a discrete probability distribution. The mean, or expected
value, provides the average outcome we would expect if the process were
repeated many times. The variance measures how spread out the values are
around the mean, which provides insight to the variability or
uncertainty in the distribution. The standard deviation, as the square
root of the variance, provides a more interpretable measure of spread in
the same units as the original variable (in this case, the number of
co-occurring substance addictions).</p>
<p>We can use the following to obtain the mean, variance, and standard
deviation of this discrete probability distribution:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rep</span>(subs<span class="sc">$</span>Var1, subs<span class="sc">$</span>Freq)) <span class="co"># mean</span></span></code></pre></div>
<pre><code>## [1] 1.572716</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">var</span>(<span class="fu">rep</span>(subs<span class="sc">$</span>Var1, subs<span class="sc">$</span>Freq)) <span class="co"># variance</span></span></code></pre></div>
<pre><code>## [1] 2.095543</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">sd</span>(<span class="fu">rep</span>(subs<span class="sc">$</span>Var1, subs<span class="sc">$</span>Freq)) <span class="co"># standard deviation</span></span></code></pre></div>
<pre><code>## [1] 1.447599</code></pre>
<p>We find the mean number of co-occurring substance addictions is
approximately 1.57; this represents the average number of co-occurring
addictions we expect across the population at-hand. We find the variance
and standard deviation are 2.095543 and 1.447599, respectively. These
measures of spread give us a sense of how spread out the values are
around the mean and are particularly useful when comparing the spread
across different populations.</p>
<p><br></p>
</div>
</div>
<div id="part-2-theoretical-probability-distributions"
class="section level2">
<h2>Part 2: Theoretical Probability Distributions</h2>
<p>So far in Lab 3, we’ve explored a discrete probability distribution
based on real data by calculating key measures like relative
frequencies, the mean, variance, and standard deviation. We can use this
concrete example to help us understand how probability distributions are
used to summarize and describe patterns in data.</p>
<p>Next, we’ll shift our focus to theoretical probability distributions
— specifically, the Binomial, Poisson, and Normal distributions. These
distributions are widely used in public health to model and predict
outcomes in scenarios where we don’t have all the data but need to make
informed decisions. By working with these distributions, we can
calculate probabilities for specific events, explore relationships
between variables, and gain deeper insight into uncertainty and
variability in public health contexts. Let’s see how these tools allow
us to answer practical probability questions and ultimately support
evidence-based decision-making. We will use a different public health
scenario for each probability distribution.</p>
<p><br></p>
<div id="binomial-distribution" class="section level3">
<h3>1. Binomial distribution</h3>
<p>As discussed in the Introduction section above, the Binomial
distribution is used to model the number of successes in a fixed number
of independent trials, where each trial has the same probability of
“success”. Remember from lecture that the terms “success” and “failure”
are arbitrary - a “success” does not necessarily mean a positive
outcome. For example, in public health, we are often studying disease
outcomes, and “success” might correspond to the occurrence of disease or
death.</p>
<p>To calculate probabilities using the Binomial distribution, you need
three key values:</p>
<ul>
<li>n: The number of trials (or sample size).</li>
<li>p: The probability of success in a single trial.</li>
<li>x: The number of successes of interest.</li>
</ul>
<p><strong>Let’s apply the Binomial distribution to the following
scenario…</strong></p>
<p>Suppose, based on data collected by the Centers for Disease Control
and Prevention (CDC), an estimate of the percentage of adults who have
at some point in their life been told they have hypertension is 48.1%
percent. The Binomial distribution can be used if the sample size (n) is
less than 10% of the population size (N), i.e., n/N ≤ 0.10. Assume for
our scenario that ‘N’ is sufficiently large relative to ‘n’ that the
binomial distribution may be used to find the desired probabilities.</p>
<p>Suppose we select a simple random sample of 20 U.S. adults and assume
that the probability that each has been diagnosed with hypertension is
0.48. We will use this information to answer each of the probability
questions below. For these items, we will use two R functions,
<code>dbinom()</code> and <code>pbinom()</code>:</p>
<ul>
<li><code>dbinom()</code>: This function is used to find the probability
for a <em>specific</em> number of successes in a given number of trials.
The syntax is <code>dbinom(x, n, p)</code> where <code>x</code> = number
of successes, <code>n</code> = number of trials, and <code>p</code> =
probability of success.</li>
<li><code>pbinom()</code>: This function is used to find the
<em>cumulative probability</em> up to a specific number of successes. In
other words, <code>pbinom()</code> gives us P(X &lt;= x). The syntax is
<code>pbinom(x, n, p)</code> where, again, <code>x</code> = number of
successes, <code>n</code> = number of trials, and <code>p</code> =
probability of success.</li>
</ul>
<p><br></p>
<div
id="a.-what-is-the-probability-that-exactly-8-out-of-20-adults-in-our-sample-have-been-diagnosed-with-hypertension"
class="section level4">
<h4>a. What is the probability that exactly 8 out of 20 adults in our
sample have been diagnosed with hypertension?</h4>
<p>In this case, the sample size (n) is 20, the number of successes of
interest (x) is 8, and the probability of “success” (i.e., that a person
has been diagnosed with hypertension) is 0.48. We can apply the
<code>dbinom()</code> function as follows:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># find probability that 8 out of 20 adults will have been diagnosed with hypertension</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">8</span>, <span class="dv">20</span>, <span class="fl">0.48</span>)</span></code></pre></div>
<pre><code>## [1] 0.1387513</code></pre>
<p>From the output in the Console window, we find the probability that
exactly 8 out of 20 adults will have been diagnosed with hypertension is
0.1387513, or about 13.9%.</p>
<p><br></p>
</div>
<div
id="b.-what-is-the-probability-that-fewer-than-8-out-of-20-have-been-diagnosed-with-hypertension"
class="section level4">
<h4>b. What is the probability that fewer than 8 out of 20 have been
diagnosed with hypertension?</h4>
<p>In this case, the sample size (n) is, again, 20, the number of
successes of interest (x) is all values <em>less than 8</em> (i.e., 0 to
7), and the probability of “success” (i.e., that a person has been
diagnosed with hypertension) is, again, 0.48. We can apply the
<code>pbinom()</code> function as follows:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># find probability that fewer than 8 out of 20 adults will have been diagnosed with hypertension</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">7</span>, <span class="dv">20</span>, <span class="fl">0.48</span>)</span></code></pre></div>
<pre><code>## [1] 0.1739206</code></pre>
<p>Remember, the <code>pbinom()</code> function gives us the
<em>cumulative</em> probability up to the specified number of successes.
So, by specifying x=7, we are telling R to give us the probability of 7
successes, plus the probability of 6 successes, plus the probability of
5 successes, and so on, all the way to 0. In this case, we find the
probability of fewer than 8 (i.e., 7 or fewer) out of 20 adults will
have been diagnosed with hypertension is equal to 0.1739206, or about
17.4%.</p>
<p><br></p>
</div>
<div
id="c.-what-is-the-probability-that-8-or-more-out-of-20-have-been-diagnosed-with-hypertension"
class="section level4">
<h4>c. What is the probability that 8 or more out of 20 have been
diagnosed with hypertension?</h4>
<p>Since the <code>pbinom()</code> function will give us the probability
that 7 or fewer have been diagnosed with hypertension, as we carried out
in part (b) above, we can subtract this probability from 1 to get the
probability that <em>8 or more</em> of the 20 will have been diagnosed
with hypertension.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># find probability that 8 or more out of 20 adults will have been diagnosed with hypertension</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="dv">7</span>, <span class="dv">20</span>, <span class="fl">0.48</span>)</span></code></pre></div>
<pre><code>## [1] 0.8260794</code></pre>
<p>In this case, we find the probability of 8 or more out of 20 adults
will have been diagnosed with hypertension is equal to 0.8260794, or
about 82.6%.</p>
<p><br></p>
</div>
<div
id="d.-what-is-the-probability-that-between-8-and-12-inclusive-out-of-20-have-been-diagnosed-with-hypertension"
class="section level4">
<h4>d. What is the probability that between 8 and 12 (inclusive) out of
20 have been diagnosed with hypertension?</h4>
<p>Finally, to find the probability of a range of successes (e.g., 8 to
12 successes, as in this example) in a binomial distribution, we add
together the probabilities for each individual number of successes
within that range. Instead of summing them manually, we can use the
cumulative probability function <code>pbinom()</code> to make this
process easier. Specifically, we calculate the cumulative probability
for the upper limit of the range (e.g., P(X≤12)) and subtract the
cumulative probability <em>just below</em> the lower limit (e.g.,
P(X≤7)). This gives the total probability for the range P(8≤X≤12).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># find probability that between 8 and 12 (inclusive) out of 20 adults will have been diagnosed with hypertension</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">12</span>, <span class="dv">20</span>, <span class="fl">0.48</span>) <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="dv">7</span>, <span class="dv">20</span>, <span class="fl">0.48</span>)</span></code></pre></div>
<pre><code>## [1] 0.7291661</code></pre>
<p>We find the probability that between 8 and 12 (inclusive) out of 20
adults will have been diagnosed with hypertension is equal to 0.7291661,
or about 72.9%.</p>
<p><br></p>
</div>
<div id="e.-mean-and-variance-of-a-binomial-distribution"
class="section level4">
<h4>e. Mean and variance of a Binomial distribution</h4>
<p>The mean (μ=n⋅p) of a binomial distribution represents the
<em>expected number of successes</em> in a given number of trials, which
provides a sense of the central tendency of the distribution. It tells
us what we can <em>typically</em> expect to happen if the process is
repeated many times. The variance (σ2=n⋅p⋅(1−p)) measures the
variability of the distribution, giving us a way to quantify how much
the number of successes is likely to deviate from the mean on average.
Together, these values help us understand both the average outcome and
the spread of possible outcomes.</p>
<p>For our scenario, suppose we want to find the mean and variance of
the number of people diagnosed with hypertension in samples of size 20.
A straightforward way to do this is to apply the mean and variance
formulas shown above, using R as a simple calculator.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># calculate the mean (n*p)  and variance is n*p*(1-p) of the binomial distribution</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="dv">20</span><span class="sc">*</span><span class="fl">0.48</span> <span class="co"># mean</span></span></code></pre></div>
<pre><code>## [1] 9.6</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="dv">20</span><span class="sc">*</span><span class="fl">0.48</span><span class="sc">*</span>(<span class="dv">1</span><span class="fl">-0.48</span>) <span class="co"># variance</span></span></code></pre></div>
<pre><code>## [1] 4.992</code></pre>
<p>We find the expected number of people to have been diagnosed with
hypertension in a sample of 20 is 9.6, with a variance of 4.992.</p>
<p><br></p>
</div>
<div id="f.-visualizing-the-binomial-distribution"
class="section level4">
<h4>f. Visualizing the Binomial distribution</h4>
<p>Finally, visualizing the Binomial distribution for a given scenario
such as this helps us understand the probability of different outcomes
at a glance. It provides a picture of where most of the probability is
concentrated, showing the likely range of successes and how extreme
outcomes are distributed. We can visualize the Binomial distribution for
our scenario (in which the sample size is 20 and probability of success
is 0.48) as follows:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># define the range of successes as 0 to 20 for the purposes of our plot</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>success <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a><span class="co"># plot the Binomial distribution</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a><span class="fu">plot</span>(success, <span class="fu">dbinom</span>(success, <span class="at">size=</span><span class="dv">20</span>, <span class="at">prob=</span><span class="fl">0.48</span>), <span class="at">type =</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p><img src="Lab_3_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>The resulting plot shows the Binomial probability distribution for
n=20 trials and a success probability (p) of 0.48. We can interpret this
plot as follows:</p>
<ul>
<li>The x-axis represents the number of successes (X), ranging from 0 to
20. Each tick corresponds to a possible outcome (e.g., 0, 1, 2, … 20
successes).</li>
<li>The y-axis represents the probability of observing each specific
number of successes.</li>
<li>Each vertical line corresponds to the probability of a particular
number of successes (P(X=x)). The height of the line shows how likely
that number of successes is.</li>
<li>The distribution is bell-shaped, with the highest probability (peak)
near the expected number of successes, which we found previously was
9.6. Since we can’t actually have 9.6 successes (since ‘X’ is discrete),
we see the highest probabilities (i.e., the most likely outcomes)
correspond to values 9 and 10.</li>
<li>Finally, the probabilities taper off as you move toward 0 or 20
successes, where extreme outcomes are less likely.</li>
</ul>
<p><br></p>
</div>
</div>
<div id="poisson-distribution" class="section level3">
<h3>2. Poisson distribution</h3>
<p>As discussed previously, the Poisson distribution models the number
of events occurring in a fixed interval of time and space, assuming the
events occur independently and at a constant average rate. To use the
Poisson distribution, you need:</p>
<ul>
<li>λ (lambda): The average number of events in the interval.</li>
<li>x: The number of events of interest.</li>
</ul>
<p><strong>Let’s apply the Poisson distribution to the following
scenario…</strong></p>
<p>In a certain population, an average of 13 new cases of esophageal
cancer are diagnosed each year. Suppose the annual incidence of
esophageal cancer follows a Poisson distribution. We will use this
information to answer each of the probability questions below. For these
items, we will use two R functions, <code>dpois()</code> and
<code>ppois()</code>:</p>
<ul>
<li><code>dpois()</code>: This function is used to find the probability
that <em>exactly</em> ‘x’ number of events occur within the time period.
The syntax is <code>dpois(x, λ)</code>, where ‘x’ is the number of
events of interest, and ‘λ’ is the mean.</li>
<li><code>ppois()</code>: This function gives the <em>cumulative
probability</em> that ‘x’ or fewer events occur within the time period.
The syntax is <code>ppois(x, λ)</code>, where, again, ‘x’ is the number
of events of interest, and lambda is the mean.</li>
</ul>
<p><br></p>
<div
id="a.-what-is-the-probability-that-in-a-given-year-the-number-of-newly-diagnosed-cases-of-esophageal-cancer-will-be-exactly-10"
class="section level4">
<h4>a. What is the probability that, in a given year, the number of
newly diagnosed cases of esophageal cancer will be exactly 10?</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># find probability that exactly 10 cases of esophageal cancer will be diagnosed</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">10</span>, <span class="dv">13</span>)</span></code></pre></div>
<pre><code>## [1] 0.08587015</code></pre>
<p>From the output in the Console, we find that, when the mean incidence
is 13 cases annually, the probability that exactly 10 cases of
esophageal cancer are diagnosed in a given year is 0.08587015, or about
8.6%.</p>
<p><br></p>
</div>
<div
id="b.-what-is-the-probability-that-in-a-given-year-the-number-of-newly-diagnosed-cases-of-esophageal-cancer-will-be-12-or-fewer"
class="section level4">
<h4>b. What is the probability that, in a given year, the number of
newly diagnosed cases of esophageal cancer will be 12 or fewer?</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># find probability that 12 or fewer cases of esophageal cancer will be diagnosed</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">12</span>, <span class="dv">13</span>)</span></code></pre></div>
<pre><code>## [1] 0.4631047</code></pre>
<p>We find that, when the mean incidence is 13 cases annually, the
probability that 12 or fewer cases of esophageal cancer are diagnosed in
a given year is 0.4631047, or about 46.3%.</p>
<p><br></p>
</div>
<div
id="c.-what-is-the-probability-that-in-a-given-year-the-number-of-newly-diagnosed-cases-of-esophageal-cancer-will-be-at-least-eight"
class="section level4">
<h4>c. What is the probability that, in a given year, the number of
newly diagnosed cases of esophageal cancer will be at least eight?</h4>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="co"># find probability that 8 or more cases of esophageal cancer will be diagnosed</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">ppois</span>(<span class="dv">7</span>, <span class="dv">13</span>)</span></code></pre></div>
<pre><code>## [1] 0.9459718</code></pre>
<p>We find that, when the mean incidence is 13 cases annually, the
probability that 8 or more cases of esophageal cancer are diagnosed in a
given year is 0.9459718, or about 94.6%.</p>
<p><br></p>
</div>
<div
id="d.-what-is-the-probability-that-in-a-given-year-the-number-of-newly-diagnosed-cases-of-esophageal-cancer-will-be-between-nine-and-15-inclusive"
class="section level4">
<h4>d. What is the probability that, in a given year, the number of
newly diagnosed cases of esophageal cancer will be between nine and 15
(inclusive)?</h4>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># find probability that between 9 and 15 (inclusive) cases of esophageal cancer will be diagnosed</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">15</span>, <span class="dv">13</span>) <span class="sc">-</span> <span class="fu">ppois</span>(<span class="dv">8</span>, <span class="dv">13</span>)</span></code></pre></div>
<pre><code>## [1] 0.663849</code></pre>
<p>We find that, when the mean incidence is 13 cases annually, the
probability that between 9 and 15 (inclusive) cases of esophageal cancer
are diagnosed in a given year is 0.663849, or about 66.4%.</p>
<p><br></p>
</div>
<div id="e.-create-a-plot-to-visualize-this-poisson-distribution."
class="section level4">
<h4>e. Create a plot to visualize this Poisson distribution.</h4>
<p>As with our plot of the Binomial distribution above, plotting the
Poisson distribution can help us understand where the highest
probabilities are concentrated. In other words, the plot can give us a
quick idea of the most likely outcomes. We can visualize the Poisson
distribution for our scenario (in which the mean number of events is 13)
as follows:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>events <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="fu">plot</span>(events, <span class="fu">dpois</span>(events, <span class="at">lambda =</span> <span class="dv">13</span>), <span class="at">type =</span> <span class="st">&#39;h&#39;</span>)</span></code></pre></div>
<p><img src="Lab_3_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>The resulting plot shows the Poisson probability distribution for the
number of events (X) ranging from 0 to 30, with an average rate (λ) of
13. Here’s how to interpret the plot:</p>
<ul>
<li>The x-axis represents the possible number of events (X), ranging
from 0 to 30. Each tick corresponds to a specific count of events (e.g.,
0, 1, 2, …, 30). Note that 30 here is arbitrary - this number of events
simply allowed for the bulk of the distribution to be visible on the
plot (since the probabilities are very tiny after about 25 events).</li>
<li>The y-axis represents the probability of observing a specific number
of events. Each vertical line corresponds to the probability of
observing exactly that many events (P(X=x)). The height of the line
shows the likelihood of that particular outcome.</li>
<li>The plot will peak near λ=13, which is the average number of events,
reflecting that this outcome is most likely.</li>
<li>The probabilities taper off to the left (fewer events) and the right
(more events) of the mean. The distribution is right-skewed, which is
characteristic of the Poisson distribution (because, technically, there
is some probability associated with any number of events), particularly
when λ is not very large.</li>
</ul>
<p><br></p>
</div>
</div>
<div id="normal-distribution" class="section level3">
<h3>3. Normal distribution</h3>
<p>Finally, the Normal distribution is a continuous probability
distribution often used to model data that are symmetrically distributed
around a mean. To calculate probabilities using the Normal distribution,
you need:</p>
<ul>
<li>μ (mu): The mean of the distribution.</li>
<li>σ (sigma): The standard deviation of the distribution.</li>
<li>x: The value or range of values for which you want to calculate the
probability.</li>
</ul>
<p>For example, the Normal distribution can be used to estimate the
likelihood of an individual’s BMI falling within a specific range in a
population. By specifying the population mean BMI (μ), the standard
deviation (σ), and the range of interest (x), you can determine the
probability of the outcome.</p>
<p>Remember, unlike the Binomial and Poisson distributions, which are
discrete, the Normal distribution is continuous. This means that
probabilities are not associated with <em>specific</em> values of X but
rather with <em>ranges</em> of values. Since the Normal distribution has
an infinite number of possible values within any interval, the
probability of any single exact value of X is essentially zero. Instead,
we calculate probabilities for a range of values by finding the area
under the standard normal curve between two points.</p>
<p><strong>Let’s apply the Normal distribution to the following
scenario…</strong></p>
<p>One of the variables collected in Birth Registry data is pounds
gained during pregnancy. According to data from the entire registry for
2021, the number of pounds gained during pregnancy was approximately
normally distributed with a mean of 30.23 pounds and a standard
deviation of 13.84 pounds. We will use this information to answer each
of the probability questions below. For these items, we will need only
one R function, <code>pnorm()</code>:</p>
<ul>
<li><code>pnorm()</code>: This function gives the <em>cumulative
probability</em> that a random variable ‘X’ takes a value less than or
equal to ‘x’. The syntax is <code>pnorm(x, mean, sd)</code>.</li>
</ul>
<p><br></p>
<div
id="a.-find-the-probability-that-a-randomly-selected-mother-in-2021-gained-less-than-15-pounds-during-pregnancy."
class="section level4">
<h4>a. Find the probability that a randomly selected mother in 2021
gained less than 15 pounds during pregnancy.</h4>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># find probability that a randomly selected mother gained less than 15 pounds</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">15</span>, <span class="fl">30.23</span>, <span class="fl">13.84</span>)</span></code></pre></div>
<pre><code>## [1] 0.1355716</code></pre>
<p>From the output in the Console, we find the probability that a
randomly selected mother in 2021 gained less than 15 pounds during
pregnancy is 0.1355716, or about 13.6%.</p>
<p><br></p>
</div>
<div
id="b.-find-the-probability-that-a-randomly-selected-mother-in-2021-gained-more-than-40-pounds-during-pregnancy."
class="section level4">
<h4>b. Find the probability that a randomly selected mother in 2021
gained more than 40 pounds during pregnancy.</h4>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># find probability that a randomly selected mother gained more than 40 pounds</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">40</span>, <span class="fl">30.23</span>, <span class="fl">13.84</span>)</span></code></pre></div>
<pre><code>## [1] 0.2401174</code></pre>
<p>We find the probability that a randomly selected mother in 2021
gained more than 40 pounds during pregnancy is 0.2401174, or about
24.0%.</p>
<p><br></p>
</div>
<div
id="c.-find-the-probability-that-a-randomly-selected-mother-in-2021-gained-between-15-and-40-pounds-during-pregnancy."
class="section level4">
<h4>c. Find the probability that a randomly selected mother in 2021
gained between 15 and 40 pounds during pregnancy.</h4>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># find probability that a randomly selected mother gained between 15 and 40 pounds</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">40</span>, <span class="fl">30.23</span>, <span class="fl">13.84</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">15</span>, <span class="fl">30.23</span>, <span class="fl">13.84</span>)</span></code></pre></div>
<pre><code>## [1] 0.6243109</code></pre>
<p>We find the probability that a randomly selected mother in 2021
gained between 15 and 40 pounds during pregnancy is 0.6243109, or about
62.4%.</p>
<p><br></p>
</div>
<div id="d.-create-a-plot-to-visualize-this-normal-distribution."
class="section level4">
<h4>d. Create a plot to visualize this Normal distribution.</h4>
<p>Visualizing the Normal distribution associated with a given scenario
can help us understand the distribution of values and predict
probabilities for ranges of interest. We can visualize the Normal
distribution for our scenario as follows:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="fl">30.23</span>, <span class="fl">13.84</span>), <span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">60</span>)</span></code></pre></div>
<p><img src="Lab_3_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>The plot shows the Normal distribution with a mean (μ) of 30.23 and a
standard deviation (σ) of 13.84. Here’s how to interpret the plot:</p>
<ul>
<li>The x-axis represents the range of possible values for the variable
of interest, spanning from 0 to 60 (an arbitrary range, but one that
allows us to view essentially the whole distribution).</li>
<li>The y-axis represents the probability density for the corresponding
x-values. The height of the curve at a given x-value indicates how
densely the data are distributed around that value but does <em>not</em>
represent the actual probability of a single point (since this is a
continuous distribution).</li>
<li>The curve is bell-shaped and symmetric, with the peak occurring at
μ=30.23, which is the most likely value.</li>
<li>Most of the probability is concentrated within 1-2 standard
deviations of the mean (approximately 30.23 ± 13.84). The tails taper
off gradually, meaning that values far from the mean (e.g., below 10 or
above 50) are less likely but still possible.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>In Lab 3, we explored theoretical probability distributions,
including the Binomial, Poisson, and Normal distributions. Probability
distributions are essential in public health for modeling uncertainty,
estimating disease risk, and predicting health outcomes in populations.
They help us understand the likelihood of events such as the spread of
infectious diseases, the probability of treatment success, or the
expected number of emergency room visits. While these concepts may feel
abstract, they provide the foundation for everything we do in
statistical inference — like helping us estimate population parameters,
assess variability, and determine the likelihood of different outcomes.
While we won’t focus heavily on probability theory in this course, this
foundational knowledge will be important as we move into statistical
inference, including confidence interval estimation, hypothesis testing,
and regression analysis.</p>
<p>When you are ready, please submit the following to the Lab 3
assignment page on Canvas:</p>
<ol style="list-style-type: decimal">
<li>An R Markdown document, which has a <code>.Rmd</code> extension</li>
<li>A knitted <code>.html</code> file</li>
</ol>
<p>Please reach out to me at <a href="mailto:jenny.wagner@csus.edu"
class="email">jenny.wagner@csus.edu</a> if you have any questions. See
you in class!</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
