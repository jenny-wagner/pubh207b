---
title: "Lab 3: Probability Distributions"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


<br>
**Jenny Wagner, PhD, MPH**
<br>
Department of Public Health
<br>
California State University, Sacramento
<br>
<br>


# Introduction





```{r}
# load packages
library(tidyverse)
library(ggplot2)
library(stats)
```

```{r}
# set working directory
setwd("/Volumes/GoogleDrive/My Drive/1_CSUS/2024-2025/Spring 2025/PUBH 207B/Website/PUBH-207B-S25")
```


# 1. Constructing and describing a discrete probability distribution

Question text: Suppose patients who were involved in a problem gambling treatment program were surveyed about co-occurring drug and alcohol addictions. Let the discrete random variable X represent the number of co-occurring addivtive substances used by the subjects. The dataset labeled "substances.csv" contains two variables: (1) a study ID number corresponding to each individual patient; and (2) the number of substances used by the corresponding patient.

## (a) Construct a table showing the frequency and relative frequency for this discrete distribution.

```{r}
# bring in dataset
data <- read.csv("substances.csv") %>% select(-X)
```

```{r}
# construct frequency table and save it as a new dataframe
subs <- as.data.frame(table(data$substances))
```

```{r}
# create a new variable for the relative frequency (i.e., the proportion of subjects with each number of substances used)
subs <- subs %>% mutate(rel_freq = Freq/(sum(Freq)))
print(subs) # print will make the table appear in your knitted file; otherwise it won't show up there
```


## (b) Create a graph of the probability distribution for these data.

```{r}
# create bar chart of relative frequencies (for each number of substances used)
ggplot(subs, aes(x=Var1, y=rel_freq)) + 
  geom_bar(stat = "identity")
```


For the next set of probability questions, it will be helpful to convert our discrete random variable X (currently labeled 'Var1') to a numeric variable.

```{r}
# Note: sometimes weird things happen when we convert a factor variable to a numeric variable right away. In this case, we need to first convert the factor variable to a character variable, then convert it to numeric...
subs$Var1 <- as.character(subs$Var1) 
subs$Var1 <- as.numeric(subs$Var1)
```


## (c) What is the probability that an individual selected at random used five addictive substances?

```{r}
# We can actually find this answer just by looking at our discrete probability distribution; however, if you want to use a code, the following will work:
sum(subs[which(subs$Var1 == 5), 3])
```
The probability that an individual selected at random used five addictive substances is 0.02574, as shown in the relative frequency table above where X = 5.


## (d) What is the probability that an individual selected at random used fewer than three addictive substances?

```{r}
# sums the values in column 3 (rel_freq) on condition that Var1 is equal to 2, 1, or 0.
sum(subs[which(subs$Var1 < 3), 3])

# an alternative method using 'filter'
subs %>% filter(Var1 < 3) %>% dplyr::summarise(sum(rel_freq))

# and another method, using R as a simple calculator
0.185328185 + 0.440154440 + 0.182754183 # sum of relative frequencies for X < 3
```


## (e) What is the probability that an individual selected at random used more than six addictive substances?

```{r}
subs %>% filter(Var1 > 6) %>% dplyr::summarise(sum(rel_freq))
```


## (f) What is the probability that an individual selected at random used between 2 and 5 addictive substances?

```{r}
subs %>% filter(Var1 >= 2 & Var1 <= 5) %>% dplyr::summarise(sum(rel_freq))
```


## (g) Find the mean, variance, and standard deviation of this frequency distribution.

```{r}
mean(rep(subs$Var1, subs$Freq)) # mean
var(rep(subs$Var1, subs$Freq)) # variance
sd(rep(subs$Var1, subs$Freq)) # standard deviation
```



# 2. Binomial distribution

Question text: Based on data collected by the Centers for Disease Control and Prevention (CDC), an estimate of the percentage of adults who have at some point in their life been told they have hypertension is 48.1% percent. Assume that 'N' is sufficiently large relative to 'n' that the binomial distribution may be used to find the desired probabilities.


## (a) Suppose we select a simple random sample of 20 U.S. adults and assume that the probability that each has been diagnosed with hypertension is .48.

### i. What is the probability that exactly eight have been diagnosed with hypertension?

```{r}
# the function 'dbinom' is used to find the probability for a specific number of successes
# the syntax is dbinom(x, n, p) where x = number of successes, n = number of trials, and p = probability of success

dbinom(8, 20, 0.48)
```


### ii. What is the probability that fewer than eight have been diagnosed with hypertension?

```{r}
# the function 'pbinom' is used to find the cumulative probability up to a specific number of successes
    # in other words, 'pbinom' gives us P(X <= x)
# the syntax is pbinom(x, n, p) where x = number of successes, n = number of trials, and p = probability of success

pbinom(7, 20, 0.48)
```


### iii. What is the probability that eight or more have been diagnosed with hypertension?

```{r}
# since 'pbinom' will give us the probability that 7 or fewer have been diagnosed with hypertension, we must subtract this probability from 1 to get the probability that 8 or more will have hypertension.

1 - pbinom(7, 20, 0.48)
```


### iv. What is the probability that between eight and 12 (inclusive) have been diagnosed with hypertension?

```{r}
pbinom(12, 20, 0.48) - pbinom(7, 20, 0.48)
```


## (b) Find the mean and variance of the number of people diagnosed with hypertension in samples of size 20.

```{r}
# one way to do this is to calculate the mean and variance using R as a simple calculator
# remember that the mean of a binomial distribution is equal to n(p) and variance is n(p)(1-p)

20*0.48 # mean
20*0.48*(1-0.48) # variance
```


## (c) Create a plot to visualize this binomial distribution.

```{r}
success <- 0:20
plot(success, dbinom(success, size=20, prob=0.48), type = 'h')
```


# 3. Poisson distribution

Question text: In a certain population, an average of 13 new cases of esophageal cancer are diagnosed each year. 

## (a) Suppose the annual incidence of esophageal cancer follows a Poisson distribution.

### i. What is the probability that, in a given year, the number of newly diagnosed cases of esophageal cancer will be exactly 10?

```{r}
# note: the function 'dpois' gives the probability that exactly 'x' number of events occur within the time period.
# the syntax for 'dpois' is ppois(x, lambda), where 'x' is the number of events of interest, and lambda is the mean.

dpois(10, 13)
```


### ii. What is the probability that, in a given year, the number of newly diagnosed cases of esophageal cancer will be 12 or fewer?

```{r}
# note: the function 'ppois' gives the cumulative probability that 'x' or fewer events occur within the time period.
# the syntax for 'ppois' is ppois(x, lambda), where 'x' is the number of events of interest, and lambda is the mean.

ppois(12, 13)
```


### iii. What is the probability that, in a given year, the number of newly diagnosed cases of esophageal cancer will be at least eight?

```{r}
1 - ppois(7, 13)
```


### iv. What is the probability that, in a given year, the number of newly diagnosed cases of esophageal cancer will be between nine and 15 (inclusive)?

```{r}
ppois(15, 13) - ppois(8, 13)
```


## (b) Create a plot to visualize this Poisson distribution.

```{r}
events <- 0:30
plot(events, dpois(events, lambda = 13), type = 'h')
```


# 4. Normal distribution

Question text: One of the variables collected in Birth Registry data is pounds gained during pregnancy. According to data from the entire registry for 2021, the number of pounds gained during pregnancy was approximately normally distributed with a mean of 30.23 pounds and a standard deviation of 13.84 pounds. 

## (a) Find the probability that a randomly selected mother in 2021 gained:

### i. Less than 15 pounds during pregnancy. 

```{r}
# note: the 'pnorm' function gives the cumulative probability that a random variable X takes a value less than or equal to x. The syntax for 'pnorm' is pnorm(x, mean, sd).

pnorm(15, 30.23, 13.84)
```


### ii. More than 40 pounds during pregnancy. 

```{r}
1 - pnorm(40, 30.23, 13.84)
```


### iii. Between 15 and 40 pounds during pregnancy. 

```{r}
pnorm(40, 30.23, 13.84) - pnorm(15, 30.23, 13.84)
```


## (b) Create a plot to visualize this normal distribution.

```{r}
curve(dnorm(x, 30.23, 13.84), from=0, to=60)
```





